#pragma once

// TO BE CONVERTED TO WINDOWS 10 21H2 64-BIT!
typedef struct _POOL_HEADER
{
	union
	{
		struct
		{
			unsigned char PreviousSize;
			unsigned char PoolIndex;
		};

		struct
		{
			unsigned char BlockSize;
			unsigned char PoolType;
		};
		unsigned long Ulong1;
	};

	unsigned long PoolTag;
	unsigned short AllocatorBackTraceIndex;
	unsigned short PoolTagHash;
} POOL_HEADER, * PPOOL_HEADER;

typedef struct _OBJECT_HEADER_QUOTA
{
	unsigned long PagedPoolCharge;
	unsigned long NonPagedPoolCharge;
	unsigned long SecurityDescriptorCharge;
	void* SecurityDescriptorQuotaBlock;
} OBJECT_HEADER_QUOTA, * POBJECT_HEADER_QUOTA;

typedef struct _EX_PUSH_LOCK
{
	union
	{
		unsigned long Locked;
		unsigned long Waiting;
		unsigned long Waking;
		unsigned long MultipleShared;
		unsigned long Shared;
	};

	unsigned long Value;
	void* Ptr;
} EX_PUSH_LOCK, * PEX_PUSH_LOCK;

typedef struct _QUAD
{
	union
	{
		unsigned long long UseThisFieldToCopy;
		float DoNotUseThisField;
	};
} QUAD, * PQUAD;

typedef struct _OBJECT_HEADER
{
	unsigned long PointerCount;
	union
	{
		unsigned long HandleCount;
		void* NextToFree;
	};

	void* Lock;
	unsigned char TypeIndex;
	unsigned char TraceFlags;
	union
	{
		unsigned char DbgRefTrace;
		unsigned char DbgTracePermanent;
	};

	unsigned char InfoMask;
	unsigned char Flags;
	union
	{
		unsigned char NewObject;
		unsigned char KernelObject;
		unsigned char KernelOnlyAccess;
		unsigned char ExclusiveObject;
		unsigned char PermanentObject;
		unsigned char DefaultSecurityQuota;
		unsigned char SingleHandleEntry;
		unsigned char DeletedInline;
	};

	union
	{
		void* ObjectCreateInfo;
		void* QuotaBlockCharged;
	};

	void* SecurityDescriptor;
	void* Body;
} OBJECT_HEADER, * POBJECT_HEADER;