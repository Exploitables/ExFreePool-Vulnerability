#pragma once

// I could not be asked to do this manually anymore.
// Thank you markhc for creating one of the most time-saving tools I have ever stumbled across.
// Link: https://github.com/markhc/windbg_to_c
typedef struct _POOL_HEADER
{
	struct {
		UCHAR PreviousSize : 8;
		UCHAR PoolIndex : 8;
	};
	struct {
		UCHAR BlockSize : 8;
		UCHAR PoolType : 8;
	};
	ULONG Ulong1;
	ULONG PoolTag;
	union {
		PVOID ProcessBilled; // Should be _EPROCESS
		USHORT AllocatorBackTraceIndex;
	};
	USHORT PoolTagHash;
} POOL_HEADER, * PPOOL_HEADER;

typedef struct _OBJECT_HEADER_QUOTA_INFO
{
	ULONG PagedPoolCharge;
	ULONG NonPagedPoolCharge;
	ULONG SecurityDescriptorCharge;
	ULONG Reserved1;
	PVOID SecurityDescriptorQuotaBlock;
	ULONGLONG Reserved2;
} OBJECT_HEADER_QUOTA_INFO, * POBJECT_HEADER_QUOTA_INFO;

typedef struct _EX_PUSH_LOCK
{
	union {
		ULONGLONG Value;
		PVOID Ptr;
		struct {
			UCHAR Locked : 1;
			UCHAR Waiting : 1;
			UCHAR Waking : 1;
			UCHAR MultipleShared : 1;
			ULONGLONG Shared : 60;
		};
	};
} EX_PUSH_LOCK, * PEX_PUSH_LOCK;

typedef struct _QUAD
{
	union {
		LONGLONG UseThisFieldToCopy;
		float DoNotUseThisField;
	};
} QUAD, * PQUAD;

typedef struct _OBJECT_CREATE_INFORMATION
{
	ULONG Attributes;
	PVOID RootDirectory;
	CHAR ProbeMode;
	ULONG PagedPoolCharge;
	ULONG NonPagedPoolCharge;
	ULONG SecurityDescriptorCharge;
	PVOID SecurityDescriptor;
	PSECURITY_QUALITY_OF_SERVICE SecurityQos;
	SECURITY_QUALITY_OF_SERVICE SecurityQualityOfService;
} OBJECT_CREATE_INFORMATION, * POBJECT_CREATE_INFORMATION;

typedef struct _OBJECT_HEADER
{
	LONGLONG PointerCount;
	union {
		LONGLONG HandleCount;
		PVOID NextToFree;
	};
	EX_PUSH_LOCK Lock;
	UCHAR TypeIndex;
	union {
		UCHAR TraceFlags;
		struct {
			UCHAR DbgRefTrace : 1;
			UCHAR DbgTracePermanent : 1;
		};
	};
	UCHAR InfoMask;
	union {
		UCHAR Flags;
		struct {
			UCHAR NewObject : 1;
			UCHAR KernelObject : 1;
			UCHAR KernelOnlyAccess : 1;
			UCHAR ExclusiveObject : 1;
			UCHAR PermanentObject : 1;
			UCHAR DefaultSecurityQuota : 1;
			UCHAR SingleHandleEntry : 1;
			UCHAR DeletedInline : 1;
		};
	};
	ULONG Reserved;
	union {
		POBJECT_CREATE_INFORMATION ObjectCreateInfo;
		PVOID QuotaBlockCharged;
	};
	PVOID SecurityDescriptor;
	QUAD Body;
} OBJECT_HEADER, * POBJECT_HEADER;
