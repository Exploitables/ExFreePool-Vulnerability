#include <Windows.h>

// I could not be asked to do this manually anymore.
// Thank you markhc for creating one of the most time-saving tools I have ever stumbled across.
// Link: https://github.com/markhc/windbg_to_c
typedef struct _POOL_HEADER_W10_21H2
{
	struct {
		UCHAR PreviousSize : 8;
		UCHAR PoolIndex : 8;
	};
	struct {
		UCHAR BlockSize : 8;
		UCHAR PoolType : 8;
	};
	ULONG Ulong1;
	ULONG PoolTag;
	union {
		PVOID ProcessBilled; // Should be _EPROCESS
		USHORT AllocatorBackTraceIndex;
	};
	USHORT PoolTagHash;
} POOL_HEADER_W10_21H2, * PPOOL_HEADER_W10_21H2;

typedef struct _OBJECT_HEADER_QUOTA_INFO_W10_21H2
{
	ULONG PagedPoolCharge;
	ULONG NonPagedPoolCharge;
	ULONG SecurityDescriptorCharge;
	ULONG Reserved1;
	PVOID SecurityDescriptorQuotaBlock;
	ULONGLONG Reserved2;
} OBJECT_HEADER_QUOTA_INFO_W10_21H2, * POBJECT_HEADER_QUOTA_INFO_W10_21H2;

typedef struct _EX_PUSH_LOCK_W10_21H2
{
	union {
		ULONGLONG Value;
		PVOID Ptr;
		struct {
			UCHAR Locked : 1;
			UCHAR Waiting : 1;
			UCHAR Waking : 1;
			UCHAR MultipleShared : 1;
			ULONGLONG Shared : 60;
		};
	};
} EX_PUSH_LOCK_W10_21H2, * PEX_PUSH_LOCK_W10_21H2;

typedef struct _QUAD_W10_21H2
{
	union {
		LONGLONG UseThisFieldToCopy;
		FLOAT DoNotUseThisField;
	};
} QUAD_W10_21H2, * PQUAD_W10_21H2;

typedef struct _OBJECT_CREATE_INFORMATION
{
	ULONG Attributes;
	PVOID RootDirectory;
	CHAR ProbeMode;
	ULONG PagedPoolCharge;
	ULONG NonPagedPoolCharge;
	ULONG SecurityDescriptorCharge;
	PVOID SecurityDescriptor;
	PSECURITY_QUALITY_OF_SERVICE SecurityQos;
	SECURITY_QUALITY_OF_SERVICE SecurityQualityOfService;
} OBJECT_CREATE_INFORMATION_W10_21H2, * POBJECT_CREATE_INFORMATION_W10_21H2;

typedef struct _OBJECT_HEADER_W10_21H2
{
	LONGLONG PointerCount;
	union {
		LONGLONG HandleCount;
		PVOID NextToFree;
	};
	PEX_PUSH_LOCK_W10_21H2 Lock;
	UCHAR TypeIndex;
	union {
		UCHAR TraceFlags;
		struct {
			UCHAR DbgRefTrace : 1;
			UCHAR DbgTracePermanent : 1;
		};
	};
	UCHAR InfoMask;
	union {
		UCHAR Flags;
		struct {
			UCHAR NewObject : 1;
			UCHAR KernelObject : 1;
			UCHAR KernelOnlyAccess : 1;
			UCHAR ExclusiveObject : 1;
			UCHAR PermanentObject : 1;
			UCHAR DefaultSecurityQuota : 1;
			UCHAR SingleHandleEntry : 1;
			UCHAR DeletedInline : 1;
		};
	};
	ULONG Reserved;
	union {
		POBJECT_CREATE_INFORMATION_W10_21H2 ObjectCreateInfo;
		PVOID QuotaBlockCharged;
	};
	PVOID SecurityDescriptor;
	PQUAD_W10_21H2 Body;
} OBJECT_HEADER_W10_21H2, * POBJECT_HEADER_W10_21H2;
