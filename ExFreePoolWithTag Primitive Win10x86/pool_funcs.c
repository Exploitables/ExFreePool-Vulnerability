#include "exploit.h"

// This should be the last time I have to remake these initialization functions.
// New Functions, rebuild of an Even (event object) pool structure.
void initialize_pool_header(PPOOL_HEADER input_pool_header)
{
	POOL_HEADER pool_header = *input_pool_header;	// dt nt!_POOL_HEADER b8c3fdc0

	pool_header.PreviousSize = 0;					// +0x000 PreviousSize     : 0y000000000 (0)
	pool_header.PoolIndex = 0;						// +0x000 PoolIndex        : 0y0000000 (0)
	pool_header.BlockSize = 0x8;					// +0x002 BlockSize        : 0y000001000 (0x8)
	pool_header.PoolType = 0;						// +0x002 PoolType         : 0y0000010 (0x2)
	pool_header.Ulong1 = 0x4080000;					// +0x000 Ulong1           : 0x4080000
	pool_header.PoolTag = 0x6E657645;				// +0x004 PoolTag          : 0x6e657645
	pool_header.AllocatorBackTraceIndex = 0x7645;	// +0x004 AllocatorBackTraceIndex : 0x7645
	pool_header.PoolTagHash = 0x6E65;				// +0x006 PoolTagHash      : 0x6e65

	*input_pool_header = pool_header;
}

void initialize_object_header_quota(POBJECT_HEADER_QUOTA input_object_header_quota)
{
	OBJECT_HEADER_QUOTA object_header_quota = *input_object_header_quota;



	*input_object_header_quota = object_header_quota;
}

void initialize_quad(PQUAD input_quad)
{
	QUAD quad = *input_quad;



	*input_quad = quad;
}

void initialize_object_header(POBJECT_HEADER input_object_header, PQUAD input_quad)
{
	OBJECT_HEADER object_header = *input_object_header;



	*input_object_header = object_header;
}