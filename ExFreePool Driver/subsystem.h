#include <ntifs.h>
#include <ntddk.h>

PDEVICE_OBJECT pgDeviceObject;
UNICODE_STRING gDev, gDos;

#define PREFIX "[ExFreePool Vulnerable Driver]"
#define BANNER \
("    ______     ______               ____              __\n" \
"   / ____/  __/ ____/_______  ___  / __ \____  ____  / /\n" \
"  / __/ | |/_/ /_  / ___/ _ \/ _ \/ /_/ / __ \/ __ \/ / \n" \
" / /____>  </ __/ / /  /  __/  __/ ____/ /_/ / /_/ / /  \n" \
"/_____/_/|_/_/   /_/   \___/\___/_/    \____/\____/_/   \n" \
"                                                        \n" \
)

#define IOCTL_FREE_POOL CTL_CODE(FILE_DEVICE_UNKNOWN, 0, METHOD_NEITHER, FILE_ANY_ACCESS)

NTSTATUS PoolDriverUnload(PDRIVER_OBJECT pDriverObject);
NTSTATUS PoolDriverCreateCloseIrp(PDEVICE_OBJECT pDeviceObject, PIRP Irp);
NTSTATUS PoolDriverDeviceIOControl(PDEVICE_OBJECT pDeviceObject, PIRP Irp);
NTSTATUS DriverEntry(PDRIVER_OBJECT pDriverObject, PUNICODE_STRING pRegistryPath);

NTSTATUS PoolDriverPrimitiveSetup(PIRP Irp, PIO_STACK_LOCATION IO);
NTSTATUS PoolDriverFreePoolPrimitive(PVOID UserBuffer);